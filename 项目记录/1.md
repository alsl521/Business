# 1、初始化项目

```
npm create vue@latest
```

本项目使用 vite （The recommended way to start a Vite-powered Vue project）创建vue。

```
TypeScript
Vue Router for Single Page Application development
Pinia for state management
```

并引入`TypeScript`，`Vue Router`，`Pinia`协助开发。

# 2、引入`Cesium`

## 1、安装

```
npm i cesium vite-plugin-cesium vite -D
```

安装`cesium`和`vite-plugin-cesium`。`cesium`是主题程序，引入`cesium`的全部内容，`vite-plugin-cesium`是在vite中帮助快速开发`cesium`，减少部分配置。

## 2、引用

在`vite.config.ts`中引入`cesium`

```typescript
import {defineConfig} from 'vite'
import vue from '@vitejs/plugin-vue'
import Cesium from "vite-plugin-cesium";

export default defineConfig({
  plugins: [vue(), Cesium(),],
});
```

## 3、使用

在项目中使用。

```vue
<template>
  <button @click="test">sss</button>
  <div id="cesiumContainer"></div>
</template>

<script setup>
import * as Cesium from "cesium";
import {getCurrentInstance, onMounted} from "vue";
import axios from "axios";

const {appContext} = getCurrentInstance();
const global = appContext.config.globalProperties;
let viewer = global.$viewer;

function test() {
  // 上述请求也可以按以下方式完成（可选）
  axios.get('/api/index/')
      .then(function (response) {

        const data = response.data.url;
        console.log(data)
        let urls = data.replace("http://localhost:8081", "/GeoServer");

        const wms = new Cesium.WebMapServiceImageryProvider({
          url: urls,
          layers: "test:sub1",
          parameters: {
            service: 'WMS',
            transparent: true,
            format: "image/png",
          },
        })

        const imageryLayer = new Cesium.ImageryLayer(wms);
        viewer.imageryLayers.add(imageryLayer);

        // 设置相机的视图
        viewer.camera.setView({
          destination: Cesium.Rectangle.fromDegrees(111, 33, 116, 36)
        });
      })
      .catch(function (error) {
        console.log(error);
      })
}

//必须在挂载后引入cesium地图组件
onMounted(() => {
  viewer = new Cesium.Viewer("cesiumContainer");
});

</script>

<style scoped>
#cesiumContainer {
  width: 100vw;
  height: 100vh;
  overflow: hidden;
}

:deep(.cesium-viewer-bottom) {
  display: none;
}
</style>
```

# 3、安装Element Plus

## 1、安装

```
npm install element-plus --save
```

## 2、完整引入

```typescript
// main.ts
import { createApp } from 'vue'
import ElementPlus from 'element-plus'
import 'element-plus/dist/index.css'
import App from './App.vue'

const app = createApp(App)

app.use(ElementPlus)
app.mount('#app')
```





# PS 项目代理

由于会出现跨域问题，所以必须设置跨域代理。在`vite.config.ts`中写入以下代码。

```typescript
export default defineConfig({
    plugins: [
        vue(), Cesium(),
    ],

    server: {
        host: '0.0.0.0',
        cors: true, // 允许跨域

        // 设置代理，根据我们项目实际情况配置
        proxy: {
            '/GeoServer': { //自行设置的请求前缀，按照这个来匹配请求，有这个字段的请求，就会进到代理来
                target: 'http://223.2.46.89:8081/',
                changeOrigin: true, //是否跨域
                rewrite: (path) => path.replace('/GeoServer', '') //重写匹配的字段，如果不需要放在请求路径上，可以重写为""
            },
            '/api': { //自行设置的请求前缀，按照这个来匹配请求，有这个字段的请求，就会进到代理来
                target: 'http://223.2.46.89:8000/',
                changeOrigin: true, //是否跨域
                secure: false,  // 如果是https接口，需要配置这个参数
                rewrite: (path) => path.replace('/api', '') //重写匹配的字段，如果不需要放在请求路径上，可以重写为""
            },
        }
    },

    resolve: {
        alias: {
            '@': fileURLToPath(new URL('./src', import.meta.url))
        }
    }
})
```

